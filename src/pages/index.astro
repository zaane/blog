---
import "../styles/global.css";
import Nav from "../components/Nav.astro";
import Projects from "../components/Projects.astro";
import SEO from "../components/SEO.astro";
import { getCollection } from "astro:content";
import type { Project } from "../types/projects";

const pageTitle = "Home | Zane Olds";
const pageDescription =
  "Portfolio of Zane Olds: teacher, learner, and software creator.";
const basePath = import.meta.env.BASE_URL.endsWith("/")
  ? import.meta.env.BASE_URL
  : `${import.meta.env.BASE_URL}/`;
const iconHref = `${basePath}orca.svg`;

const currentProjectRows: Array<{ order: number; project: Project }> = [];

const projectEntries = await getCollection("projects");

for (const entry of projectEntries) {
  const [category] = entry.id.split("/");
  if (category !== "current") {
    continue;
  }

  const { order, ...project } = entry.data;
  currentProjectRows.push({
    order: order ?? Number.MAX_SAFE_INTEGER,
    project,
  });
}

currentProjectRows.sort(
  (a, b) => a.order - b.order || a.project.name.localeCompare(b.project.name),
);
const currentProjects = currentProjectRows.map(({ project }) => project);
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href={iconHref} />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <SEO title={pageTitle} description={pageDescription} />
  </head>
  <body>
    <main class="page home-layout">
      <div class="home-hero page-shell">
        <Nav />

        <header class="intro">
          <span class="intro-header">
            <h1>Zane Olds</h1>
            <span class="subtitle">Teacher, learner, software creator.</span>
            <div>
              Seattle, WA
              <span class="dot">•</span>
              <a href="mailto:zaneolds@gmail.com">zaneolds@gmail.com</a>
            </div>
          </span>
          <div class="copy">
            <p>
              Trained in physics and mathematics with a passion for solving hard
              problems and communicating technical ideas, I’ve spent the last
              few years teaching a variety of subjects, helping others learn
              some of what I know: anything from the theorems of calculus and
              the mysteries of thermodynamics to the subtleties of English
              grammar or the drama of the French Revolution.
            </p>
            <p>
              My passion for learning brought me to studying foreign languages,
              and then to learning software development to try to make the
              process easier for myself. Now I'm building educational software
              and trying to make learning easier for everyone.
            </p>
          </div>
        </header>
      </div>

      <Projects projects={currentProjects} />
    </main>
  </body>
</html>
